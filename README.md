# CodeCraft2022

##### 团队名：三只Monster立大功

##### 排名：初赛成渝第七  复赛成渝第一  决赛全国第七



## 算法思路

### 复赛

- #### 关于边缘节点的排序

1. 排序需要综合考虑到边缘节点的度和带宽，经分析，当按照带宽/度从大到小排序时，效果较好。因为这样能保证度小的边缘节点在前面尽量分满，而度大的边缘节点即便在后面分也能分得一个较高的值。
2. 如果完全按照带宽/度从大到小排序，可能会导致一些带宽较小的边缘节点在前面就被选定，这样可能导致在该节点选定的Top5时刻中需求较大的流无法卸载至该节点上。所以我们按照带宽大小对边缘节点进行了二分类，将带宽大于所有时刻最大流需求的边缘节点归类为大节点，小于最大流需求的边缘节点归类为小节点。在排序时，一定是先排大节点，再排小节点。其中大节点和小节点之中的排序依旧按照带宽/度从大到小来。

- #### 关于边缘节点对自身Top5时刻的选择以及该时刻对流的选择

1. 整体还是按照需求从大到小选择。
2. 由于复赛引入了base-cost的概念，那么若想要维持一个较低的价格，则需要尽量让需求高于base-cost的流在边缘节点的Top5时刻被分完，否则在该流一定超过base-cost带来惩罚价格。所以我们对流进行了分类，将需求高于base-cost的流分为大流，在边缘节点选择Top5时刻时，先对每个时刻大流的需求进行排序，优先选择大流需求最大的时刻作为Top5时刻。若此时剩余时刻大流需求已经达到了一个较低的水平，则剩下的Top5时刻依然按照总体需求由大到小进行选择。
3. 当节点选择完时刻后，对该时刻的所有流进行排序，排序方法为需求/度从大到小。这么做是为了让需求大的流尽量在前面分，也为了让可卸载边缘节点数量少的流尽快被分完。从前往后遍历一个个流，直到流被遍历完或边缘节点已无剩余带宽。

- #### 关于边缘节点选择完Top5时刻后对剩余的流的处理

1. 在第一波分完后，将剩余所有的流进行排序，排序方法为流的需求/度从大到小。原因与上面一样。
2. 遍历之前排完序的每个流，选择每个流的目的边缘节点。将选择分为三个优先级。第一优先级：若该流的需求不大于base-cost，则判断是否能够选择一个边缘节点，使得该流卸载到该边缘节点后，边缘节点在该时刻的带宽用量依然不超过base-cost。第二优先级：在该优先级中，流卸载到任意边缘节点都会一定会超过base-cost，此时需要判断该流是否能够卸载到一个边缘节点上，使得该节点在该时刻的价格不超过该节点之前维护的价格。第三优先级：在该优先级中，流的卸载一定会导致边缘节点价格的增加，此时需要计算出该流卸载至每个边缘节点导致的价格增加量，选择价格增加量低的边缘节点，此时还需要考虑边缘节点的度，度大的边缘节点将能容忍更大的价格增加量。



### 决赛

有时间再写写。
